<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Anagrams solver</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="img/scrabble.png">
    <link rel="apple-touch-icon" href="img/scrabble.png">

    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/normalize.css">
</head>
<body>

    <div id="title">
        <h1>Anagrams solver</h1>
    </div>

    <div id="anagrams-request">
        <form action="http://localhost:8080/anagrams/" onsubmit="searchForAnagrams(this);return false">
            <input type="text" name="text" placeholder="Edit me and use <Enter> to searching for Anagrams">
        </form>

        <div id="error" style="display: none; color: red">Some wrong!!! Sorry, try again</div>
    </div>

    <script type="application/javascript">
        const HttpCodes = {
            SUCCESS : 200,
            NOT_FOUND : 404
        };

        function searchForAnagrams(form) {
            var error = document.getElementById("error");
            error.style.display = "none";

            const searchText = encodeURIComponent(form.text.value);
            if (searchText) {
                const url = form.action + searchText;

                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function() {
                    if (this.readyState === 4) {
                        if (this.status === HttpCodes.SUCCESS) {
                            const jsonResponse = JSON.parse(this.responseText);
                            console.log(jsonResponse);
                        }

                        if (this.status === HttpCodes.NOT_FOUND) {
                            error.style.display = "block";
                        }
                    }
                };

                xhttp.open(form.method, url, true);
                xhttp.send();
            }
        }

        window.onload = function () {
        };
    </script>
</body>
</html>